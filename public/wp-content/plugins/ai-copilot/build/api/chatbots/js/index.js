(()=>{"use strict";var t={d:(e,s)=>{for(var a in s)t.o(s,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:s[a]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{INITIAL_STATE:()=>h,QUADLAYERS_AICP_STORE_NAME:()=>m,STORE_NAME:()=>i,actions:()=>a,fetchRestApiChatbots:()=>u,reducer:()=>c,resolvers:()=>o,selectors:()=>s,useApiChatbots:()=>C});var s={};t.r(s),t.d(s,{getChatbots:()=>d});var a={};t.r(a),t.d(a,{createChatbot:()=>g,deleteChatbot:()=>S,editChatbot:()=>_,setChatbots:()=>y});var o={};t.r(o),t.d(o,{getChatbots:()=>T});var c={};t.r(c),t.d(c,{default:()=>w});const r=window.wp.data,i="aicp/chatbots/store",h={chatbots:[]},d=t=>t.chatbots,n=window.wp.i18n,b=window.wp.notices,p=window.aicp.helpers,{QUADLAYERS_AICP_API_REST_ROUTES:l}=aicpApiChatbots,u=({method:t,data:e}={})=>(0,p.apiFetch)({path:l.chatbots,method:t,data:e});function C(){const{createChatbot:t,editChatbot:e,deleteChatbot:s}=(0,r.useDispatch)(i),{chatbots:a,isResolvingChatbots:o,hasResolvedChatbots:c}=(0,r.useSelect)((t=>{const{isResolving:e,hasFinishedResolution:s,getChatbots:a}=t(i);return{chatbots:a()||[],isResolvingChatbots:e("getChatbots"),hasResolvedChatbots:s("getChatbots")}}),[]);return{chatbots:a,isResolvingChatbots:o,hasResolvedChatbots:c,hasChatbots:!(!c||!a?.length),createChatbot:t,editChatbot:e,deleteChatbot:s}}const y=t=>({type:"SET_CHATBOTS",payload:t}),g=t=>async({registry:e,dispatch:s,select:a})=>{const o=a.getChatbots(),c=await u({method:"POST",data:t});return c?.code||c?.message?(e.dispatch(b.store).createSuccessNotice((0,n.sprintf)("%s: %s",c.code,c.message),{type:"snackbar"}),!1):(o.push(c),s.setChatbots([...o]),e.dispatch(b.store).createSuccessNotice((0,n.__)("The chatbot has been created successfully.","ai-copilot"),{type:"snackbar"}),c.chatbot_id)},S=t=>async({registry:e,dispatch:s,select:a})=>{const o=a.getChatbots(),c=await u({method:"DELETE",data:{chatbot_id:t}});if(c?.code||c?.message)return e.dispatch(b.store).createSuccessNotice((0,n.sprintf)("%s: %s",c.code,c.message),{type:"snackbar"}),!1;const r=o.filter((e=>parseInt(e.chatbot_id)!==parseInt(t)));return s.setChatbots([...r]),e.dispatch(b.store).createSuccessNotice((0,n.sprintf)((0,n.__)("The chatbot %s has been deleted.","ai-copilot"),t),{type:"snackbar"}),!0},_=t=>async({registry:e,dispatch:s,select:a})=>{const o=a.getChatbots(),c=await u({method:"PATCH",data:t});return c?.code||c?.message?(e.dispatch(b.store).createSuccessNotice((0,n.sprintf)("%s: %s",c.code,c.message),{type:"snackbar"}),!1):(s.setChatbots([...o.map((e=>e.chatbot_id==t.chatbot_id?t:e))]),e.dispatch(b.store).createSuccessNotice((0,n.__)("The chatbot has been updated successfully.","ai-copilot"),{type:"snackbar"}),!0)},T=async()=>{try{const t=await u({method:"GET"});return y(t)}catch(t){console.error(t)}};function w(t=h,e){return"SET_CHATBOTS"===e.type?{...t,chatbots:e.payload}:t}const f=(0,r.createReduxStore)(i,{reducer:w,actions:a,selectors:s,resolvers:o});(0,r.register)(f);const m=i;(window.aicp=window.aicp||{})["api-chatbots"]=e})();